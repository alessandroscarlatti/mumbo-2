var MessageBus=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t){let r=0;e.exports=class{constructor(){this._functionPointerLib={},this._functionPointerCounter=0,this._createProxySubscriber(),this._id="MessageBus@"+r,r++}set send(e){this._send=e}set subscriber(e){this._objSubscriber=e}_createProxySubscriber(){const e={get:(e,t)=>{if(null!=this._functionPointerLib[t])return this._functionPointerLib[t];if(null!=this._objSubscriber)return this._objSubscriber[t];throw new Error("Cannot find property "+t+" on subscriber.")}};this._proxySubscriber=new Proxy({},e)}get publisher(){if(null==this._proxyPublisher){const e=this,t={get:function(t,r){return function(){let t=e._dehydrateArgs(arguments),n={type:"function",name:r,args:t},o=JSON.stringify(n);e._send(o)}}};this._proxyPublisher=new Proxy({},t)}return this._proxyPublisher}receive(e){console.log(this._id+" received message",e);let t=JSON.parse(e);const r=this._hydrateArgs(t.args,{});try{this._proxySubscriber[t.name](...r)}catch(e){console.log(e)}}_hydrateArgs(e,t){let r=[];return e.forEach(e=>{var t=null;const n=this;switch(e.type){case"function":t=function(){let t=n._dehydrateArgs(arguments),r={type:"function",name:e.name,args:t},o=JSON.stringify(r);n._send(o)};break;case"string":t=String(e.value);break;case"number":t=Number(e.value);break;case"boolean":t=Boolean(e.value);break;case"json":t=JSON.parse(e.value);break;default:throw new Error("Unhandled argument type: "+e.type)}r.push(t)}),r}_dehydrateArgs(e){let t=[];for(let r=0;r<e.length;r++){let n=e[r];if("string"==typeof n)t.push({type:"string",value:String(n)});else if("function"==typeof n){let e="f@"+this._functionPointerCounter;this._functionPointerCounter++,this._functionPointerLib[e]=n,t.push({type:"function",name:e})}else if("number"==typeof n)t.push({type:"number",value:n});else if("boolean"==typeof n)t.push({type:"boolean",value:n});else{if("object"!=typeof n)throw new Error("Unsupported argument type for arg: "+n);t.push({type:"json",value:JSON.stringify(n)})}}return t}}}]);